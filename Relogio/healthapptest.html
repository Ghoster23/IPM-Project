<!DOCTYPE html>
<html>

  <head>
    <title> Health App Test</title>
    <link rel="stylesheet" href="stylemenu1.css">
    <link rel="stylesheet" href="stylehealthapp.css">
  </head>

  <body>
    <div id="clock">
        <!-- Dark Background -->
        <div id="backgroundcircle"></div>
        <div class="menu1" style="overflow: hidden;">
            <!-- loading -->
            <canvas id="loading"></canvas>
            <!-- result -->
            <div id="result"> Resultado<br>do teste:</div>
            <!-- result text -->
            <span id="resulttext"> place_holder_text</span>
        </div>
        <!-- Back Button -->
        <a href="healthapp.html">
            <img src="back.png" id="back" on>
        </a>

        <!-- Bezzle --> 
        <img src="bezel.png" id="bezel"> 
    </div>
    
<!-- Functions for the scrolling -->
<script>

    function getRandomArbitrary(min, max) {
        return Math.random() * (max - min) + min;
    }

    //decide on the string to put for the result :)
    var testtype = localStorage.getItem("testtype");
    var resultstring="default";

    switch(testtype){
        //teste alcoolemia
        case "1":
        resultstring=getRandomArbitrary(0,0.7).toFixed(2).toString()+"%";
        break;
        //tete de pressao arterial
        case "2":
        resultstring=getRandomArbitrary(110,170).toFixed(0).toString()+"/"+getRandomArbitrary(70,110).toFixed(0).toString()+"\nmmHg";
        break;   
        //teste de narcoticos
        case "3":
            switch(getRandomArbitrary(0,0).toFixed(0)){
                case "0":
                resultstring="Não foram\nencontradas\nsubstâncias";
                document.getElementById('resulttext').style.top = "90px";
                break;
                /*place holder de futuro pensar numa maneira de mostrar as substâncias no sangue
                case "1":
                resultstring="yes";
                break;*/
            }
        break;
        //ritmo cardiaco
        case "4":
        resultstring=getRandomArbitrary(49,121).toFixed(0).toString()+" bpm";
        break;
        //teste de glicémia
        case "5":
        resultstring=getRandomArbitrary(5,13).toFixed(0).toString()+" %";
        break;
    }
    document.getElementById('resulttext').textContent=resultstring;    


    //take care of making the circular progress bar :o
    var ctx = document.getElementById('loading').getContext('2d');
    var percentage = 0;
    var start = 4.72;
    var cw = ctx.canvas.width =210;
    var ch = ctx.canvas.height= 210;
    var color = localStorage.getItem("color");

    var diff;
    function progressSim(){
        diff = ((percentage / 100) * Math.PI*2*10).toFixed(2);
        ctx.clearRect(0, 0, cw, ch);
        ctx.lineWidth = 40;
        ctx.fillStyle = "#FFFFFF";
        ctx.strokeStyle = color;

        ctx.font="20px sans-serif";
        ctx.textAlign = 'center';
        ctx.fillText(percentage+'%', cw*.5, ch*.5+8, cw);
        ctx.beginPath();
        ctx.arc(cw/2, ch/2, cw/2-10 , start, diff/10+start, false);
        ctx.stroke();
        if(percentage >= 100){
            //upon finishing clear canvas and make visible test results
            clearTimeout(sim);
            
            ctx.clearRect(0, 0, cw, ch);
            ctx.arc(cw/2, ch/2, cw/2-10 , start, diff/10+start, false);
            ctx.stroke();

            document.getElementById('result').style.visibility= "visible";
            document.getElementById('resulttext').style.visibility= "visible";
        }
        percentage++;
    }
    var sim = setInterval(progressSim, 50);

</script>

  </body>

</html>